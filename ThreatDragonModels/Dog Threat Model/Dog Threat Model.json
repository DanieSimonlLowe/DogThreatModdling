{
  "version": "2.2.0",
  "summary": {
    "title": "Council Dog Infrastructure Model",
    "owner": "The Council",
    "description": "Description:\n1. Register a dog\nOwners can register their dogs on the Council’s application webpage. They use their personal details, i.e. pronoun,\nfirst and last name, email address, and physical address where the dog will be located and where the tag needs to be\nshipped to (same address for both). When registering the dog, they submit its name, and breed. Upon completion\nof the registration process, they receive a unique registration number, and an expiry date for the registration. An\ninvoice is generated in PDF and sent by email to the owner, that the owner will have to pay by bank transfer,\nindicating the registration number in reference. A tag with a unique ID is created. The tag ID is an 8 digit unique\nnumber such that at any time, there are no dogs with the same tag ID. The tag will be sent to the address indicated\nby the owner.\n\n2. Renew a registration\nBefore the end of a registration (typically after a year since the registration), owners have to renew a dog’s registration.\nTo this end, they have to input the latest tag ID, and the address to deliver the new tag to. A new invoice\nwill be created and sent to the email address matching that tag. The new tag, with a new ID, will be associated to\nthe dog previously associated to the tag to renew.\n\n3. Terminate a registration\nOwners can terminate a dog’s registration in the event of moving to a new city, the dog being passed to a new\nowner, or the dog’s death. To terminate a dog’s registration, the owner needs to input their email address, the tag\nID, and the dog’s name. A confirmation email will be sent to the owners to confirm that the dog is not registered\nanymore, and that the tag can be destroyed. The email also contains a link to the registration process on the\nCouncil’s application in case the dog’s registration was terminated by mistake.\n\n4. Declare a lost dog.\nOwners can report their dog as lost. To this end, they need to encode their email address used to register the dog,\nand the dog’s name. The Council system will send a confirmation email of the dog’s lost status, with the last known\ntag ID, also displayed on the confirmation webpage.\n\n5. Report a found dog.\nMembers of the public can report found dogs that seem to be lost. For this, they have to input the dog’s tag ID,\nand a physical address where the dog is currently located, so dog services can come and pick it up. The Council will\nthen contact the owner on their email address, matching the tag ID.\n\nList of Actors:\n1. Dog Owners: These are people who interact with the system intending to register a dog, or who have an existing registration.\n2. Members of the Public: These are people who interact with the system to report found dogs. Dog owners can be members of the public, as can council employees.\n3. Council Employees: These are people employed by the Council with special credentials.\n\nList of Constraints and Dependencies:\n- The system must be available publicly on a website from both desktop and mobile devices\n- The full software application is deployed on-premise, controlled by the Council's staff\n- Council staff maintain the infrastructure (hardware) that runs the software application\n\nList of Trust Levels:\n\nList of Entry/Exit Points:\n\nList of Assets:\n\nPotential Improvements to Functional Aspects, and Threat Analysis:\n",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Isla Smyth"
      },
      {
        "name": "Campbell Shephard"
      },
      {
        "name": "Chloe McLaren"
      },
      {
        "name": "Daniel Lowe"
      }
    ],
    "diagrams": [
      {
        "id": 0,
        "title": "Main Diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 160,
              "y": 170
            },
            "size": {
              "width": 1720,
              "height": 560
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Council Internal Systems"
              }
            },
            "zIndex": -1,
            "id": "dcc1f2a7-9eb0-4711-bc7f-6b74d5dd640e",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Council Internal Systems",
              "description": "Processes and stores within these boundaries are maintained by the Council.",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 580,
              "y": 960
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Dog Owner"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "id": "ed2114a9-83dd-4de7-90d8-9e78a9154740",
            "data": {
              "type": "tm.Actor",
              "name": "Dog Owner",
              "description": "A person who legally owns one or more dogs and is in the council's range of authority, so wants to register their dog or manage their already existing regulations.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [],
              "threatFrequency": {
                "spoofing": 9,
                "repudiation": 4
              }
            }
          },
          {
            "position": {
              "x": 363.74999999999955,
              "y": 575
            },
            "size": {
              "width": 160,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Register Dog \nWeb Page"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "id": "16724b90-f94d-4606-bf4d-53fce0427c94",
            "data": {
              "type": "tm.Process",
              "name": "Register Dog \nWeb Page",
              "description": "HTTPS webpage endpoint(s) for dog registration.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "0f8643c2-00d2-4cbd-a67b-8d1879c1cadc",
                  "title": "Fake Information",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Someone could enter fake information, meaning the authorities no longer know who owns the dog, or if the dog even exists.",
                  "mitigation": "- Use a system like Real Me to verify the person's identity.\n- Make people send a photo of them self holding photo ID\n- Check the email address/physical address are legitimate (filter for common fake subdomains)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                },
                {
                  "id": "7be99b0d-4aa7-4e2e-842e-d2b0a96730e4",
                  "title": "Claim against Registration",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "Owner performs registration, then claims they didn't register any such dog.",
                  "mitigation": "- Log all registration actions to the system. Include relevant information about the request, i.e., IP address, time/date",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                },
                {
                  "id": "9de7e80c-a490-44c3-8cd0-0717add131a7",
                  "title": "Website spoofing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Someone could create a fake version of this website, causing people to give their information to the wrong people.",
                  "mitigation": "- Prioritise shorter URLs\n- Purchase and redirect from similar domains",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 36,
                  "score": ""
                },
                {
                  "id": "847e0abc-b2be-49c1-a44e-f5b5f9e490b5",
                  "title": "Data Manipulation",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Someone could do a man-in-the middle attack and view and manipulate the data while it is in transit.",
                  "mitigation": "By using HTTPS this is prevented as the data is encrypted in transit so they could only do this if they got the data from the connection at the very start.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 62,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 6,
                "tampering": 0,
                "repudiation": 3,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 840,
              "y": 340
            },
            "size": {
              "width": 150,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Dog Datastore"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 4,
            "id": "4b55e8bf-facd-41e5-af05-a13ca80e9464",
            "data": {
              "type": "tm.Store",
              "name": "Dog Datastore",
              "description": "Stores information relating to dog entities known under the council.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "02be0fae-cd34-42cb-bdba-143f392536eb",
                  "title": "Database Injection",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Injection attacks could be used to change the database's information.",
                  "mitigation": "- Follow industry practices for sanitising input\n- Ensure all libraries used are up-to-date and screened for CSE vulnerabilities\n- Create frequent backups of the database and store them externally",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "88c51c1d-e276-4442-8437-3a79fd61cf06",
                  "title": "Disclosure by Injection",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Injection attacks could be used to get information.",
                  "mitigation": "- Follow industry practices for sanitising input\n- Ensure all libraries used are up-to-date and screened for CSE vulnerabilities",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                },
                {
                  "id": "fb0e0c1b-3c44-4333-b931-ca48bb3bd828",
                  "title": "Flooding Attack",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Too many requests in a short amount of time could overwhelm the data store and cause it to stop.",
                  "mitigation": "Rate limit interactions with the datastore.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "37a29e9b-b224-4237-8eab-bc1d921f6de5",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "If an attacker gains access to the database, then they could view all the information in the database easily.\n",
                  "mitigation": "Hash all user information by the generated tag ID so that user information can only be received if you have the tag ID.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 50,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 5,
                "repudiation": 0,
                "informationDisclosure": 4,
                "denialOfService": 2
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "renew invoice",
              "description": "Personalised email addressed to the owner, with invoice attached as a PDF.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "08970db7-2b73-4d20-9e75-c09c97bb228e",
            "labels": [
              "renew invoice"
            ],
            "source": {
              "cell": "22b104b5-98ac-45a3-9b15-539274c78fbe"
            },
            "target": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "vertices": [
              {
                "x": 730,
                "y": 750
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "confirmation email",
              "description": "Personalised email addressed to the owner confirming that the dog of specified ID is no longer registered. Includes a link to the registration page.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "89d98b58-17e3-4068-8644-6101244b09a6",
            "labels": [
              "confirmation email"
            ],
            "source": {
              "cell": "b3a56483-7ae4-41c2-8423-f2d274cd0479"
            },
            "target": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "vertices": [
              {
                "x": 910,
                "y": 750
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "renew invoice details",
              "description": "Contains details pertinent to the renew registration email invoice that were not obtained in the web form process: full name, pronouns, registration number, and email address.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e1787528-e131-442c-a0b1-5fcc2264c9f9",
            "labels": [
              "renew invoice details"
            ],
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "22b104b5-98ac-45a3-9b15-539274c78fbe"
            },
            "vertices": [
              {
                "x": 680,
                "y": 450
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "terminate email details",
              "description": "Contains details for personalising the termination confirmation email that were not obtained in the terminate process: the owner's full name and pronouns, and the registration ID.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a0984ecb-cca2-4359-9b30-902b2b4061be",
            "labels": [
              "terminate email details"
            ],
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "b3a56483-7ae4-41c2-8423-f2d274cd0479"
            },
            "vertices": [
              {
                "x": 860,
                "y": 510
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "termination details",
              "description": "Contains tag ID and flag for if a dog's registration has been terminated.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e4674566-eb2c-4002-ba74-9b713962184b",
            "labels": [
              "termination details"
            ],
            "source": {
              "cell": "b3a56483-7ae4-41c2-8423-f2d274cd0479"
            },
            "target": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "vertices": [
              {
                "x": 780,
                "y": 460
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "terminate form",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "fab41eba-1d7e-4b0b-b3db-443dac36c74d",
            "labels": [
              "terminate form"
            ],
            "source": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "target": {
              "cell": "b3a56483-7ae4-41c2-8423-f2d274cd0479"
            },
            "vertices": [
              {
                "x": 800,
                "y": 800
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "lost dog form",
              "description": "Form consisting of the owner's email address and dog's name.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "6cc8a549-0635-402d-9c12-f59e7c8f32d6",
            "labels": [
              "lost dog form"
            ],
            "source": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "target": {
              "cell": "b9288f98-11fa-4c59-9a38-a295a750eaef"
            },
            "vertices": [
              {
                "x": 980,
                "y": 830
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "lost dog email details",
              "description": "Contains the dog's tag ID, along with details for email personalisation -- owner's full name and pronouns.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "2f1a5c7e-2466-417a-89f7-6568d53be986",
            "labels": [
              "lost dog email details"
            ],
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "b9288f98-11fa-4c59-9a38-a295a750eaef"
            },
            "vertices": [
              {
                "x": 970,
                "y": 430
              },
              {
                "x": 1010,
                "y": 490
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "lost dog email",
              "description": "Confirmation email for a lost dog declaration, confirming the dog's last known tag ID.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "8e5048b7-1619-4be0-85e5-f6e2f5c0a67d",
            "labels": [
              "lost dog email"
            ],
            "source": {
              "cell": "b9288f98-11fa-4c59-9a38-a295a750eaef"
            },
            "target": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "vertices": [
              {
                "x": 1045,
                "y": 850
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "found dog details",
              "description": "Contains the dog's tag ID, current status, and possibly the reported sighting address.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "1f759114-62bd-4e67-94a2-285656595f4f",
            "labels": [
              "found dog details"
            ],
            "source": {
              "cell": "5b9cb350-4ebb-46fd-acac-07fd96e4e0ed"
            },
            "target": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "lost dog details",
              "description": "Contains the owner's email address, dog's name, and status to update to.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a8937180-b178-487b-bfc7-67483bf7164f",
            "labels": [
              "lost dog details"
            ],
            "source": {
              "cell": "b9288f98-11fa-4c59-9a38-a295a750eaef"
            },
            "target": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "vertices": [
              {
                "x": 960,
                "y": 540
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "renew details",
              "description": "Contains both the old and new tag IDs, the new physical address, and a new expiry date. Sets the flag is_paid to false.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "fca1da01-6ecd-4d3d-9ecc-4efe61941dc9",
            "labels": [
              "renew details"
            ],
            "source": {
              "cell": "22b104b5-98ac-45a3-9b15-539274c78fbe"
            },
            "target": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "vertices": [
              {
                "x": 650,
                "y": 420
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "renew form data",
              "description": "Form consisting of dog's tag ID and new delivery address.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "b57a490f-4135-4530-a8b4-bf3dfb2e88cc",
            "labels": [
              "renew form data"
            ],
            "source": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "target": {
              "cell": "22b104b5-98ac-45a3-9b15-539274c78fbe"
            },
            "vertices": [
              {
                "x": 660,
                "y": 750
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Reqeast Invoice Infomation",
              "description": "The information for the provided reference that is required to send the tag is retrieved, so the dog ID and the address.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "5d674e1b-de34-4800-a615-48a3befe21c2",
            "labels": [
              "Reqeast Invoice Infomation"
            ],
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "vertices": [
              {
                "x": 1393.25,
                "y": 390
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": "4 3"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Pay Registration Invoice",
              "description": "The dog owner pays for the invoice from their registration with the details listed in the invoice.\n",
              "outOfScope": true,
              "reasonOutOfScope": "The system only indirectly interacts with this as dog owners pay outside the system and council employees check the accounts outside the system.\n",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "60dd0281-f240-4daf-abc0-b395eabcb784",
            "labels": [
              "Pay Registration Invoice"
            ],
            "source": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "target": {
              "cell": "5cef187f-ed69-498a-81d8-dfe09b582ecf"
            },
            "vertices": [
              {
                "x": 1400,
                "y": 1010.5
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": "4 3"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Recive Invoice",
              "description": "Council employees check that the bank transfers made to the assacated bank account.\n",
              "outOfScope": true,
              "reasonOutOfScope": "The system only indirectly interacts with this as dog owners pay outside the system and council employees check the accounts outside the system.\n",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "408241b0-14ca-425f-a29a-0b0e82df2c70",
            "labels": [
              "Recive Invoice"
            ],
            "source": {
              "cell": "5cef187f-ed69-498a-81d8-dfe09b582ecf"
            },
            "target": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "vertices": [
              {
                "x": 1692.25,
                "y": 740
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Send Invoice",
              "description": "An invoice is generated and mailed to the dog owner.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "7cfd0ebf-36d4-40dd-8712-2db78090e072",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Someone could be a man in the middle and spy on people using the application for getting information like their address and email.\n\n\n",
                  "mitigation": "All emails would be encrypted, so this information could not be disclosed.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 42,
                  "score": ""
                },
                {
                  "id": "1e5b9ce6-05d3-4997-81fa-d5ba05dcb6d0",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Someone could be a man in the middle and change on people using the application for getting information like their address and email.",
                  "mitigation": "All emails would be encrypted, so the emails can't be changed.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 43,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 4,
                "informationDisclosure": 4,
                "denialOfService": 0
              }
            },
            "id": "1dfeeb3d-bc37-412a-9edb-ad088585dd3c",
            "labels": [
              "Send Invoice"
            ],
            "source": {
              "cell": "fc2db507-c5e6-4513-bccf-768066f4a232"
            },
            "target": {
              "x": 580,
              "y": 990
            },
            "vertices": [
              {
                "x": 263.75,
                "y": 780
              },
              {
                "x": 303.75,
                "y": 960
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Registration triggered Invoce Details",
              "description": "Once registration details have been updated, invoice details are generated in the database and sent to the mail service.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "cb0a5314-57c3-4936-a760-26be2df62cfd",
            "labels": [
              "Registration triggered Invoce Details"
            ],
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "fc2db507-c5e6-4513-bccf-768066f4a232"
            },
            "vertices": [
              {
                "x": 900,
                "y": 260
              },
              {
                "x": 680,
                "y": 280
              },
              {
                "x": 316,
                "y": 350
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Send Fake Invoice",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "748cd052-2be4-42c8-b9e6-f870d58cf071",
            "labels": [
              "Send Fake Invoice"
            ],
            "source": {
              "cell": "b013e8fa-926e-42de-858c-aaf27fa61890"
            },
            "target": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Notify Invoice Received",
              "description": "The employee notifies the system that they have sent the tag and that the invoice is now paid by providing the invoice refrance.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "9f718ec8-d077-4418-8405-af3c6761c9c9",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "\nSomeone could falsely claim that someone they know has paid for a tag when they have not.",
                  "mitigation": "All actions are logged, and work is checked over by other employees.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 52,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "id": "ab3c8e22-50ee-4181-b3b5-26e70a8f3e98",
            "labels": [
              "Notify Invoice Received"
            ],
            "source": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "target": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "vertices": [
              {
                "x": 1520,
                "y": 630
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Sign In",
              "description": "Council credentials, including email and password.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "7f19fa6c-ce8c-4ce6-85b7-609c69c10e12",
            "labels": [
              "Sign In"
            ],
            "source": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "target": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "vertices": [
              {
                "x": 1623.25,
                "y": 580
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "ack sign in",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "56251d83-fffb-4fce-8df3-0395b1275668",
            "labels": [
              "ack sign in"
            ],
            "source": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "target": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "vertices": [
              {
                "x": 1580,
                "y": 590
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Reqeast Invoice Data",
              "description": "The employee enters the invoice reference to find information about the linked dog owner so that they can create and send the tag.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "3d13faa4-f776-4840-b5c0-efbf6dc0bc23",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An employee could maliciously request data about someone they know, e.g., they could get data about their X.\n",
                  "mitigation": "Only information can be searched by invoice registration number, and only the address and dog tag are provided.\n\nAll activity by an account is logged, so malacies searches can be found.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 51,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "id": "ba905dc6-5e8f-49a5-9860-ab0f6c952006",
            "labels": [
              "Reqeast Invoice Data"
            ],
            "source": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "target": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "vertices": [
              {
                "x": 1686.25,
                "y": 540
              },
              {
                "x": 1650,
                "y": 540
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Recive data linked to Invoice ",
              "description": "The employee receives the data linked to the reqeasted invoice so that they can create and send a tag, so the address and the dog id\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "56984a17-4d0e-4ccd-a8ff-c97c075a9895",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An employee could maliciously request data about someone they know, e.g., they could get data about their X.",
                  "mitigation": "only the address and dog tag are provided",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 55,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 3,
                "denialOfService": 0
              }
            },
            "id": "69277476-28d3-49f8-bd32-49a3983ea73b",
            "labels": [
              "Recive data linked to Invoice "
            ],
            "source": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "target": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "vertices": [
              {
                "x": 1630,
                "y": 480
              },
              {
                "x": 1753.25,
                "y": 505
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Update Invoice State",
              "description": "The invoice is marked as paid for the provided reference.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "b48daa45-55d3-4cae-83c5-ad5d7202ad64",
            "labels": [
              "Update Invoice State"
            ],
            "source": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "target": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": "4 3"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Reqeast Tag",
              "description": "The council employee manually requests the tags to be made and shipped to the address that the invoice is related to.\n",
              "outOfScope": true,
              "reasonOutOfScope": "The council employee manually requests the tags to be made and shipped out of any of the systems.\n",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "159f7a05-9261-47e4-8d38-9e86b7963f46",
            "labels": [
              "Reqeast Tag"
            ],
            "source": {
              "cell": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8"
            },
            "target": {
              "cell": "dfce18fd-50f2-4580-8311-35f8defb524d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "found dog form",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "270ffe56-6729-4c48-9cfa-5364dd2ba155",
            "labels": [
              "found dog form"
            ],
            "source": {
              "cell": "33bfc317-430a-410f-85b8-2229b95eaa3e"
            },
            "target": {
              "cell": "5b9cb350-4ebb-46fd-acac-07fd96e4e0ed"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "ack and send tag id",
              "description": "acknowledges that a regulation was successful and gets the generated unique dog ID\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "b3d3c460-1b0e-434b-a6c2-e09820ebc3b2",
            "labels": [
              "ack and send tag id"
            ],
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "16724b90-f94d-4606-bf4d-53fce0427c94"
            },
            "vertices": [
              {
                "x": 760,
                "y": 340
              },
              {
                "x": 420,
                "y": 370
              },
              {
                "x": 370,
                "y": 530
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "credentials",
              "description": "Employee credentials (i.e., email/password)",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "6c91561a-97da-4f98-8cd1-fe638d304bcc",
            "labels": [
              "credentials"
            ],
            "source": {
              "cell": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1"
            },
            "target": {
              "cell": "3d07850d-1ba3-4fe6-9d29-059925f38693"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e0ca6b97-3c09-4a60-adb5-474470434480",
            "source": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "target": {
              "cell": "10eb3a27-dc6c-42fc-b3aa-f65101362a1d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "04f95306-a85e-41ca-8db1-a26ce4663619",
            "source": {
              "cell": "10eb3a27-dc6c-42fc-b3aa-f65101362a1d"
            },
            "target": {
              "cell": "f9addc46-2f9b-41cc-a38a-80379ddad8e7"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "ACK",
              "description": "acknowledges that the registration was successful, and informs the owner of the registration number and expiry date for the registration.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "a1378a6f-1445-4379-a8ee-77eec2318beb",
                  "title": "Spying",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "some one could spy on the infomation while it is in transit.\n",
                  "mitigation": "By using HTTPS, someone would need to see the start of the communication to be able to intercept the communication.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "37e2bbe5-6374-44c7-abef-692782598728",
                  "title": "Tampering",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Acknowledgement could be tampered with; i.e., changing registration number to another registration. Since this is used in the reference for a bank transfer, the owner could end up failing to pay their own registration.",
                  "mitigation": "Use HTTPS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 56,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 5,
                "denialOfService": 0
              }
            },
            "id": "73ab2cb9-50a6-4a05-be06-24f92caa2996",
            "labels": [
              "ACK"
            ],
            "source": {
              "cell": "16724b90-f94d-4606-bf4d-53fce0427c94"
            },
            "target": {
              "x": 600,
              "y": 960
            },
            "vertices": [
              {
                "x": 520,
                "y": 790
              },
              {
                "x": 560,
                "y": 870
              },
              {
                "x": 580,
                "y": 920
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Enter Dog Regstration Infomation",
              "description": "Enters the information for registering a dog.\nthe human pronoun, first and last name, email address, and physical address, and the dog's name and breed. This information is used to create a new entry in the database.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": [
                {
                  "id": "869fa001-8c81-46aa-93a5-5f45af62e438",
                  "title": "Data manipulation",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Someone could do a man-in-the middle attack and view and manipulate the data while it is in transit.",
                  "mitigation": "By using HTTPS this is prevented as the data is encrypted in transit so they could only do this if they got the data from the connection at the very start.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                },
                {
                  "id": "0cb527d7-ab64-4e20-bd91-d11bdf8a4d69",
                  "title": "Flood with Fake Applications",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Someone could flood the end point with fake applications.\n",
                  "mitigation": "Rate limit the endpoint\n\nHave a white list for allowed requests.\n\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "0fa180d6-f9f3-4d60-9bd8-8779b84a6ccc",
                  "title": "Information Spying",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Someone could be a man in the middle and spy on people using the application, therefore getting information like their address and email",
                  "mitigation": "By using HTTPS, someone would need to see the start of the communication to be able to intercept the communication.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 4,
                "informationDisclosure": 4,
                "denialOfService": 3
              }
            },
            "id": "b06da6de-4b42-494c-a56b-053f68d4e2b1",
            "labels": [
              "Enter Dog Regstration Infomation"
            ],
            "source": {
              "cell": "ed2114a9-83dd-4de7-90d8-9e78a9154740"
            },
            "target": {
              "cell": "16724b90-f94d-4606-bf4d-53fce0427c94"
            },
            "vertices": [
              {
                "x": 550,
                "y": 960
              },
              {
                "x": 490,
                "y": 950
              },
              {
                "x": 451.75,
                "y": 910
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Add registration details",
              "description": "Contains all of the details from the registration form: the human pronoun, first and last name, email address, and physical address, and the dog's name and breed. This information is used to create a new entry in the database.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "id": "81037ae8-4ec3-425e-a1c0-e810a5e79a57",
            "labels": [
              "Add registration details"
            ],
            "source": {
              "cell": "16724b90-f94d-4606-bf4d-53fce0427c94"
            },
            "target": {
              "cell": "4b55e8bf-facd-41e5-af05-a13ca80e9464"
            },
            "vertices": [
              {
                "x": 451.75,
                "y": 490
              },
              {
                "x": 510,
                "y": 400
              },
              {
                "x": 720,
                "y": 370
              }
            ]
          },
          {
            "position": {
              "x": 570,
              "y": 580
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Renew\nRegistration"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "id": "22b104b5-98ac-45a3-9b15-539274c78fbe",
            "data": {
              "type": "tm.Process",
              "name": "Renew\nRegistration",
              "description": "HTTPS webpage endpoint(s) for renewing a dog's registration.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 778.75,
              "y": 580
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Terminate\nRegistration"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "id": "b3a56483-7ae4-41c2-8423-f2d274cd0479",
            "data": {
              "type": "tm.Process",
              "name": "Terminate\nRegistration",
              "description": "HTTPS webpage endpoint(s) for terminating a dog's registration.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 990,
              "y": 580
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Declare Lost\nDog"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 18,
            "id": "b9288f98-11fa-4c59-9a38-a295a750eaef",
            "data": {
              "type": "tm.Process",
              "name": "Declare Lost\nDog",
              "description": "HTTPS webpage endpoint(s) for declaring a dog as lost.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1338.5,
              "y": 525.0000000000001
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Report \nFound Dog"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 19,
            "id": "5b9cb350-4ebb-46fd-acac-07fd96e4e0ed",
            "data": {
              "type": "tm.Process",
              "name": "Report \nFound Dog",
              "description": "HTTP webpage endpoint(s) for reporting a dog as found.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1310,
              "y": 870
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Member of\nthe Public"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 20,
            "id": "33bfc317-430a-410f-85b8-2229b95eaa3e",
            "data": {
              "type": "tm.Actor",
              "name": "Member of\nthe Public",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1630,
              "y": 620
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Council\nEmployee"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 21,
            "id": "758635f0-86c5-41a6-b45f-b9b5ff4a98a8",
            "data": {
              "type": "tm.Actor",
              "name": "Council\nEmployee",
              "description": "A person who works for the company in an admin role for the system.\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "bc90fd83-68a1-4c04-9581-b9d3ee035962",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "Some one could log in as an employee.\n",
                  "mitigation": "Have long secure passwords that must change every month and make it so that employees can only access the system localy",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 49,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 0
              }
            }
          },
          {
            "position": {
              "x": 1488.5,
              "y": 425.0000000000001
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Manage\nRegistration"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 26,
            "id": "19a0ecde-7e89-4eef-80f5-8690d3fee6c1",
            "data": {
              "type": "tm.Process",
              "name": "Manage\nRegistration",
              "description": "Council-only end-point for viewing and manipulating the dog registration datastore directly.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "7e172ff5-0f17-4ec8-a19f-4d147acd41d8",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "A concil employee could get the personal information of people in the system for their own use e.g., they could get their X address if they have a dog and know some of their personal information.\n",
                  "mitigation": "To request customer data, they need to use the invoice registration number, and only the address and the tag ID will be returned.\nAll actions by the employee are also recorded so that any malicious activity can be found.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 47,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 4,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 1626.25,
              "y": 280
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Employee\nCredential\nDatastore"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 27,
            "id": "3d07850d-1ba3-4fe6-9d29-059925f38693",
            "data": {
              "type": "tm.Store",
              "name": "Employee\nCredential\nDatastore",
              "description": "Stores all council employee credentials.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 175.74999999999955,
              "y": 570
            },
            "size": {
              "width": 160,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Mail Service"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 28,
            "id": "fc2db507-c5e6-4513-bccf-768066f4a232",
            "data": {
              "type": "tm.Process",
              "name": "Mail Service",
              "description": "HTTPS webpage endpoint(s) for dog registration.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "5db0c222-76ad-4c92-aedf-7fbe54465858",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Too many mail requests could be made that cause the system to only send some of them.",
                  "mitigation": "\n\nRate limit intraction with the emailer and keep a stack of all the emails that still need to be sent.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 1626.25,
              "y": 950
            },
            "size": {
              "width": 120,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Process Bank \nTransfer"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 30,
            "id": "5cef187f-ed69-498a-81d8-dfe09b582ecf",
            "data": {
              "type": "tm.Process",
              "name": "Process Bank \nTransfer",
              "description": "Used to transfer money between accounts so that money can be paid\n",
              "outOfScope": true,
              "reasonOutOfScope": "The system only indirectly interacts with this as dog owners pay outside the system and council employees check the accounts outside the system.\n",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1930,
              "y": 840
            },
            "size": {
              "width": 130,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Create \nand Send\nTag"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 31,
            "id": "dfce18fd-50f2-4580-8311-35f8defb524d",
            "data": {
              "type": "tm.Process",
              "name": "Create \nand Send\nTag",
              "description": "The system for creating and sending the tags to dog owners\n",
              "outOfScope": true,
              "reasonOutOfScope": "The council employee manually requests the tags to be made and shipped out of any of the systems.\n",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 963.75,
              "y": 230
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Threats like Man in the\nmiddle are not applicable\nas this is an internal server."
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 32,
            "id": "e98a0b2a-377c-437a-8695-2becd9a1b09a",
            "data": {
              "type": "tm.Text",
              "name": "Threats like Man in the\nmiddle are not applicable\nas this is an internal server.",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 47.5,
              "y": 1080
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Attacker"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 33,
            "id": "b013e8fa-926e-42de-858c-aaf27fa61890",
            "data": {
              "type": "tm.Actor",
              "name": "Attacker",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "bb712146-3a7d-45de-a8c1-9dec5c7689ef",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker could create a fake invoice in the same style as the real invoices and send them to customers they know are getting dogs and are in the area, so that they can steal money from them.\n",
                  "mitigation": "The invoices would contain all the information you entered about you and your dog, including the random ID, which the registration form will ask the user to keep for this purpose, so that to accurately fake an invoice, the attacker would have to have access to the database.\n\nWell, in the likely case that a user forgot there tag id they would still need there other infomation.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 40,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 0
              }
            }
          },
          {
            "position": {
              "x": 1311.25,
              "y": 210
            },
            "size": {
              "width": 110,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Retrieve\nLost Dog"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "id": "10eb3a27-dc6c-42fc-b3aa-f65101362a1d",
            "zIndex": 34,
            "data": {
              "type": "tm.Process",
              "name": "Retrieve\nLost Dog",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1540,
              "y": 90
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Animal Control"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "id": "f9addc46-2f9b-41cc-a38a-80379ddad8e7",
            "zIndex": 35,
            "data": {
              "type": "tm.Actor",
              "name": "Animal Control",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          }
        ]
      }
    ],
    "diagramTop": 1,
    "reviewer": "SENG406 Teaching Team",
    "threatTop": 62
  }
}